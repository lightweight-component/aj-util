<h1>WeiXinCrypto 教程</h1>
<p>本教程提供了 <code>WeiXinCrypto</code> 类的概述，该类是 <code>lightweight-component/aj-util</code> 库的一部分。<code>WeiXinCrypto</code> 类为微信相关操作提供了加密和解密实用工具。</p>
<h2>简介</h2>
<p><code>WeiXinCrypto</code> 类包含用于处理微信加密和解密操作的静态方法，包括：</p>
<ul>
<li>AES-256-GCM 解密</li>
<li>小程序手机号解密</li>
<li>RSA-OAEP 加密/解密</li>
<li>RSA 签名生成</li>
</ul>
<h2>主要特性</h2>
<ul>
<li>API v3 的 AES-256-GCM 解密</li>
<li>小程序加密数据解密</li>
<li>使用证书的 RSA-OAEP 加密</li>
<li>RSA 签名生成</li>
<li>证书验证</li>
</ul>
<h2>方法</h2>
<h3>1. AES 解密</h3>
<ol>
<li><code>aesDecryptToString(byte[] aesKey, byte[] associatedData, byte[] nonce, String cipherText)</code> - AEAD_AES_256_GCM 解密</li>
<li><code>aesDecryptPhone(String iv, String cipherText, String sessionKey)</code> - 小程序手机号解密</li>
</ol>
<h3>2. RSA 加密/解密</h3>
<ol>
<li><code>encryptOAEP(String message, X509Certificate certificate)</code> - RSA-OAEP 加密</li>
<li><code>decryptOAEP(String cipherText, PrivateKey privateKey)</code> - RSA-OAEP 解密</li>
<li><code>rsaEncrypt(String message, String certPath)</code> - 使用证书文件的 RSA 加密</li>
</ol>
<h3>3. 签名</h3>
<ol>
<li><code>rsaSign(PrivateKey privateKey, byte[] data)</code> - RSA 签名生成</li>
</ol>
<h2>使用示例</h2>
<h3>AES 解密</h3>
<pre><code class="language-java">String decrypted = WeiXinCrypto.aesDecryptToString(
    apiKey.getBytes(), 
    associatedData.getBytes(),
    nonce.getBytes(),
    cipherText
);

String phone = WeiXinCrypto.aesDecryptPhone(iv, cipherText, sessionKey);
</code></pre>
<h3>RSA 加密</h3>
<pre><code class="language-java">String encrypted = WeiXinCrypto.encryptOAEP(message, certificate);
String encryptedFromFile = WeiXinCrypto.rsaEncrypt(message, &quot;path/to/cert.pem&quot;);
</code></pre>
<h3>RSA 解密</h3>
<pre><code class="language-java">String decrypted = WeiXinCrypto.decryptOAEP(cipherText, privateKey);
</code></pre>
<h3>签名生成</h3>
<pre><code class="language-java">String signature = WeiXinCrypto.rsaSign(privateKey, data.getBytes());
</code></pre>
<h2>实现说明</h2>
<ul>
<li>使用 Java 加密体系结构 (JCA)</li>
<li>支持基于文件和直接证书输入</li>
<li>内部处理 Base64 编码/解码</li>
<li>验证证书过期时间</li>
</ul>
<h2>结论</h2>
<p><code>WeiXinCrypto</code> 类提供了全面的实用工具，用于处理微信相关的加密操作，使与微信服务的集成更加方便。</p>
